---
import ExampleGrid from "@/components/example-grid.astro";
import PageHeader from "@/components/page-header.astro";
import MainLayout from "@/layouts/main-layout.astro";
import { automaRegistry, getAllThemes } from "@/config/automa-registry";
import type { MenuItem } from "@/types";

// Convert automa to MenuItem format for ExampleGrid
const themes = getAllThemes();
const automaByTheme = themes.map((theme) => {
  const items: MenuItem[] = automaRegistry
    .filter((a) => a.theme === theme)
    .map((automa) => ({
      title: automa.title,
      href: `/automa/${automa.slug}`,
      description: automa.description,
      image: `/images/examples/placeholder.jpg`, // Using placeholder for now
    }));

  return { theme, items };
});

const typographyTheme = automaByTheme.find((entry) => entry.theme === "Typography");
const classicThemes = automaByTheme.filter((entry) => entry.theme !== "Typography");

---

<MainLayout title="Explore">
  <div class="bg-background-200">
    <section class="container py-12">
      <PageHeader
        heading="Explore"
        text="Interactive animation modules. Click any tile to experience."
      />

      {
        typographyTheme && (
          <div class="mt-12 space-y-4">
            <p class="text-sm text-muted-foreground max-w-2xl leading-relaxed">
              Typography Lab automa reuse the same control stack as the classic explorations. Launch
              any tile to tweak parameters with the collapsible panel while the animation runs in
              situ.
            </p>
            <ExampleGrid title="Typography Lab" items={typographyTheme.items} />
          </div>
        )
      }

      <div class="mt-12 space-y-6">
        <div class="space-y-2">
          <p class="text-xs uppercase tracking-[0.3em] text-muted-foreground">Classic</p>
          <h2 class="text-2xl font-heading tracking-tight text-foreground">Core Templates</h2>
          <p class="text-sm text-muted-foreground max-w-2xl leading-relaxed">
            Select a foundational automa to use as a starting point for production work.
          </p>
        </div>

        <div class="space-y-4">
          {classicThemes.map(({ theme, items }) => (
            <ExampleGrid title={theme} items={items} />
          ))}
        </div>
      </div>

    </section>
  </div>
</MainLayout>
